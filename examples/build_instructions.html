<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- --COPYRIGHT--,BSD
 *  Copyright (c) 2013, Texas Instruments Incorporated
 *  All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 *
 *  *  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *  *  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *  *  Neither the name of Texas Instruments Incorporated nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 *  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 *  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 *  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 *  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 *  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * --/COPYRIGHT--
-->
<html>
<head>
    <title>Codec Engine Example Build Instructions</title>
    <!-- For now, we use the doxygen style sheet -->
    <link type="text/css" rel="stylesheet" href="../docs/html/doxygen.css">
    <!-- doxygen's css .memproto's all have tables for a little extra pad...
         don't like tables, so give 'em a little extra left pad ourselves
    --->
    <style type="text/css">
    body {
        margin: 20px;
    }
    </style>
</head>
<body>
<table width="100%">
  <tbody>
    <tr>
      <td bgcolor="black" width="1">
        <a href="http://www.ti.com">
          <img src="../docs/html/tilogo.gif" border="0" alt="Texas
          Instruments">
        </a>
      </td>
      <td bgcolor="red">
        <img src="../docs/html/titagline.gif" alt="Technology for
        Innovators(tm)">
      </td>
    </tr>
  </tbody>
</table>
<h1>Build/Run Instructions for Codec Engine Examples</h1>
<hr>
<h2>General Information</h2>
<p>This page explains how to build the examples provided in the
Codec Engine (CE) product.
</p>
<p>Examples currently contain the simple pass-through (copy) codecs,
implemented in the XDM algorithm standard.
</p>
<p>More details are available at the
  <a href="http://tiexpressdsp.com/index.php?title=Codec_Engine_Examples">
   Codec Engine Examples</a> wiki article.
</p>
<hr>
<h2>Requirements</h2>
<p>See the <a href="../codec_engine_3_24_00_08_ReleaseNotes.html">Release Notes</a>
for the specific software and hardware components this release of
Codec Engine has been validated against.
</p>
<hr>
<h2>Directory Structure</h2>
<p>Examples are provided in zip file format under the directory
<ul><tt>&lt;CE_INSTALL_DIR&gt;/examples/archive</tt>, </ul> where
<tt>&lt;CE_INSTALL_DIR&gt;</tt> is the root directory of your Codec Engine
insatallation. Under the <tt>archive</tt> directory, you will find
directories named for platforms containing zipped examples specific to
the given platform.  Each example is self-contained, so that it can be
unzipped and built in a directory of your choice.  It is also possible
to build all the examples for your platform from the makefile located in
<tt>&lt;CE_INSTALL_DIR&gt;/examples</tt>.
</p>
Directories containing examples:
<pre>
examples
    +---archive <span style="color: rgb(0, 164, 0);"> Platform directories </span>
        +---C6A8149_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for C6A8149 EVM </span>
        +---C6678_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for C6472 EVM </span>
        +---C6472_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for C6472 EVM </span>
        +---OMAP3530_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for OMAP3530 EVM </span>
        +---TI814X_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for TI814X EVM </span>
        +---TI816X_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for TI816X EVM </span>
		+---TI811X_bios_elf<span style="color: rgb(0, 164, 0);"> Zipped BIOS examples for TI811X EVM </span>
</pre>

The archive folders ending in "_elf" build the BIOS executables with ELF
format.
<hr>
<h2>Building the examples: step-by-step instructions</h2>
Here we will describe the steps to build all the examples for your
platform, from the root of the <tt>examples</tt> directory.
<p><i>Important</i>: throughout the rest of this document, we will use the
following notation:
</p>
<ul>
  <li><tt>&lt;CE_INSTALL_DIR&gt;</tt> - root directory of your Codec Engine
  installation. The original examples are in
  <tt>&lt;CE_INSTALL_DIR&gt;/examples</tt>.</li>
  <li><tt>&lt;CE_EXAMPLES_INSTALL_DIR&gt;</tt> - absolute path of the
  examples directory or the copy you made,
  e.g. <tt>&lt;CE_INSTALL_DIR&gt;/examples</tt></li> or
  <tt>/usr/work/examples</tt></li>
  <li><tt>&lt;BIOS_INSTALL_DIR&gt;</tt> - root directory of your SYS/BIOS
  installation.</li>
  <li><tt>&lt;XDC_INSTALL_DIR&gt;</tt> - root directory of your xdctools
  installation.</li>
</ul>

<h3>1. Dependencies</h3>
<p>Dependencies can be set in $(CE_INSTALL_DIR)/products.mak.  This file is
then included by the individual example makefiles, if they are built under
<tt>&lt;CE_INSTALL_DIR&gt;/examples</tt>.  You can also copy the
$(CE_INSTALL_DIR)/products.mak to a specific example directory if you move
the example to another location.</p>
<h4>INSTALL_DIR</h4>
<ul>
  <li> The many <b>INSTALL_DIR</b> variables let you set the path to other
  dependent components. Depending on the programs you are building and the
  devices you build for, you will need to set the path for one or more of
  these components.  If your distribution includes cetools/, you can set
  many of these variables to $(CE_INSTALL_DIR)/cetools.
  </li>
</ul>

<h4>Codegen Tools</h4>
<ul>
  <li>Correct code generation tool paths will need to be specified for the
  architectures you will be building for. For instance, to build for the C6472
  device, you will need to set the appropriate cgtools variables to the TI C64x
  toolchain location.<br />
  Note that for TI toolchains, this is the directory that contains bin/,
  include/, and lib/ subdirectories.<br />
  </li>
</ul>

<h3>2. [Optional] Copy the entire "examples" tree out of the product.</h3>
It may no longer be necessary to copy the entire "examples" tree out of the
product, since all examples are now contained in .zip files, which can be
re-extracted to recover the original example.  However, if you do copy
the examples folder to another location, you will need to
<ul>
copy <span style="color: rgb(153, 0, 0);">&lt;CE_INSTALL_DIR&gt;/products.mak</span> to <span style="color: rgb(153, 0, 0);">&lt;CE_EXAMPLES_INSTALL_DIR&gt;</span>
</ul>
<p>

<h3>3. Manage examples makefile</h3>
<p>
At the root of the examples directory you will find the makefile,
which must be edited for your particular platform.
Edit the following variable in <b>makefile</b>, as described below.
</p>
<p>
<b>NOTE:</b> You may not want to build all the examples for a particular
platform.  For example, if you have the <b>EZSDK</b> for the <b>TI816X</b>
platform, you should not build the BIOS or remote Linux VIDEO-M3 and VPSS-M3
examples.
You can control to some extent, which examples are built by editing
the <b>examples.inc</b> file at the root of the examples directory, and
commenting out the examples you do not want to build. For example, by
commenting out these lines in examples.inc, when you run
<i>make</i> at the root of the examples directory, none of the BIOS only
examples will be unzipped and built for the TI816X platform:
<p>
<pre>
<span style="color: rgb(0, 164, 0);">
ifeq ("$(DEVICE)","TI816X")
</span><span style="color: rgb(0, 0, 255);">
#    example_apps += TI816X_bios_elf/ex01_universalcopy_dsp
#    example_apps += TI816X_bios_elf/ex01_universalcopy_video
#    example_apps += TI816X_bios_elf/ex01_universalcopy_vpss
</span>
</pre>
</p>
<p>
You will also need to edit the makefile of the unzipped remote Linux
example, if you don't want to build the remote VIDEO-M3 and VPSS-M3
examples.  For example, comment out all lines containing <span style="color: rgb(153, 0, 0);">video</span> and <span style="color: rgb(153, 0, 0);">vpss</span>
in <tt>ex01_universalcopy_remote/makeflle</tt> as shown below:
<pre><span style="color: rgb(0, 164, 0);">
host:
	$(MAKE) -C  codec_dsp
	$(MAKE) -C  dsp</span><span style="color: rgb(0, 0, 255);">
#	$(MAKE) -C  codec_video
#	$(MAKE) -C  video
#	$(MAKE) -C  codec_vpss
#	$(MAKE) -C  vpss</span><span style="color: rgb(0, 164, 0);">
	$(MAKE) -C  host

install:
	$(MAKE) -C  host INSTALL_DIR=$(INSTALL_DIR) install
	$(MAKE) -C  dsp INSTALL_DIR=$(INSTALL_DIR) install</span><span style="color: rgb(0, 0, 255);">
#	$(MAKE) -C  video INSTALL_DIR=$(INSTALL_DIR) install
#	$(MAKE) -C  vpss INSTALL_DIR=$(INSTALL_DIR) install</span>
<span style="color: rgb(0, 164, 0);">
clean::
	$(MAKE) -C  host $@
	$(MAKE) -C  codec_dsp $@
	$(MAKE) -C  dsp $@</span><span style="color: rgb(0, 0, 255);">
#	$(MAKE) -C  codec_video $@
#	$(MAKE) -C  video $@
#	$(MAKE) -C  codec_vpss $@
#	$(MAKE) -C  vpss $@</span>
</pre>

</p>
<h4>3.1 DEVICE</h4>
<p>
The <tt>DEVICE</tt> variable indicates which hardware platforms should be
built for.  Set this variable to one of the supported platforms listed in
the <b>makefile</b>.
</p>

<p>
The makefile in the top-level example directory unzips the examples for
the specified device, into the examples directory, and then builds them.

Each example contains a GNU <tt>makefile</tt> and a <tt>products.mak</tt>,
which enable you to build it in the directory where it is unzipped. The
<tt>products.mak</tt> for the individual example will look for a
products.mak file one, two, or three directories above, to allow for a
common products.mak file that can be used for the examples.

<p>Please keep in mind that <b><span style="color: rgb(153, 0, 0);">MOST
BUILD TROUBLES OCCUR WHEN ONE OF THE VARIOUS <tt>*_INSTALL_DIR</tt>
VARIABLES ARE INCORRECT!</span></b>
Make sure there are no extra spaces (check the end of lines!), that every
individual path (segment separated by the semicolon) is correct, character
for character, and the build process is very likely to go smoothly.
</p>


<h3>4. Build examples</h3>
<p>After updating the variables described above, from your examples/ directory, type:</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>

<p>All examples appropriate for your specified environment and device will be
built.  This will include codecs, extensions, servers (if applicable) and
apps.</p>

<p>To copy the built examples to a location on your target's file system,
type:</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake install INSTALL_DIR=&lt;INSTALL_DIR&gt;</b>
</p>
where &lt;INSTALL_DIR&gt; is the location to copy to.

<p>If for whatever reason you want to remove all the extracted examples,
type:</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clobber</b>
</p>

<hr>
<h2>Running the example applications</h2>

<p>All of these examples are single core examples that can be run by loading the executable on the corresponding core in CCS and letting it run till the end. In most cases logging/trace is enabled and that will generate useful output on the Console.
<p>

<hr>
<h2>Memory map</h2>
The platform specific memory maps for the servers that are used by remote
apps, are located in the _config.bld file where the server is built.  For
example, ex01_universalcopy_dsp/dsp/_config.bld contains the memory
map for the DSP.
<p>
In case you need to modify the memory map, you can modify the _config.bld
file as needed.

<hr>
<p>
Last updated: June 13, 2013
</p>
</body>
</html>
